version: '1.0'
steps: 
    build-step:
        description: Building the image.
        title: Build the Docker image...
        type: build
        dockerfile: Dockerfile
        image-name: aloncodefresh/demochat
        tag: codefresh
    freestyle-step:
        description: Freestyle step..
        title: Free styling
        image: nhoag/curl
        commands:
          - echo "step 1"
          - echo "Path is $PATH"
          - echo ---------------------------- START
          - echo /codefresh/volume/cf_export IS
          - cat /codefresh/volume/cf_export
          - echo ---------------------------- END          
    freestyle-step6:
        description: Freestyle step 6..
        title: Free styling 66
        image: alpine:latest
        commands:
          - echo "Step 6"
          - echo "Path is $PATH"          
          - echo ---------------------------- START
          - echo /codefresh/volume/env_vars_to_export IS
          - cat /codefresh/volume/env_vars_to_export
          - echo ---------------------------- END
    composition-step:
      title: Running as a composition...
      description: Attempting to run as part of composition.
      type: composition
      composition: 
        version: '2'
        services:
          app:
            image: nhoag/curl
            environment:
              - echo ANOTHER is ${{ANOTHER}} and also ${ANOTHER} and also $ANOTHER
              - echo ANOTHER2 is ${{ANOTHER2}} and also ${ANOTHER2} and also $ANOTHER2
          app2:
            image: nhoag/curl
            environment:
              - echo SOME is ${{SOME}}  
              - echo SOME2 is ${{SOME2}}                            
      composition-candidates:
        main:
          image: nhoag/curl
          command: bash -c "sleep 20" | echo 'works'
