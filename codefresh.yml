version: '1.0'
steps:
    build-step:
        description: Building the image.
        title: Build the Docker image...
        type: build
        dockerfile: Dockerfile
        image-name: aloncodefresh/demochat
        tag: codefresh
    unit-test-via-gulp:
      description: Running unit test via gulp.
      title: Run the Gulp unit test...
      image: monostream/nodejs-gulp-bower:latest
      working-directory : ${{initial-clone}}
      commands:
        - npm install
        - gulp test
        - echo $(date)
    unit-test-via-npm:
      description: Running unit test via npm.
      image: ${{build-step}}
      commands:
        - npm test
        - echo $(date)
    push-step:
        description: Pushing image to Docker hub.
        type: push
        candidate: ${{build-step}}
        tags: [ ${{CF_BRANCH}}, latest, anotherTag ]        
