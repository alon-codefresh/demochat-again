version: '1.0'
steps:
    build-step:
        description: Building the image.
        title: Build the Docker image...
        type: build
        dockerfile: Dockerfile
        image-name: aloncodefresh/demochat
        tag: codefresh
        
    travis_step:
      type: travis
      services:
        redis:
          image: redis
          ports:
            - 6379
          environment:
            SOME_VAR: "Test 123"
            SOME_OTHER_VAR: "Test 123"
        mongo:
          image: mongo
      test:
        image: nhoag/curl
        command: bash -c "sleep 20 && curl http://app:5000/" | echo 'works'
    

    travis_step_2:
      type: travis
      services:
        redis:
          image: redis
          ports:
            - 6379
          environment:
            - SOME_VAR="Test 123"
            - "SOME_OTHER_VAR=Test123"
        mongo:
          image: mongo
      test:
        image: nhoag/curl
        command: bash -c "sleep 20 && curl http://app:5000/" | echo 'works'
    
